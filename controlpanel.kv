#: import AlignedTextInput allignedtextinput.AlignedTextInput
#: import datetime datetime.datetime
#: import Snackbar kivymd.uix.snackbar.Snackbar
#: import ActionTab action_tab.ActionTab
#: import SettingTab setting_tab.SettingTab

<MainScreen>
    orientation: "vertical"

    MDBoxLayout:
        size_hint_y: None
        height: '48dp'
        md_bg_color: app.theme_cls.primary_dark
        MDIconButton:
            icon: app._type_options[app.type]
            theme_text_color: "ContrastParentBackground"
            on_release: app.change_type()
        MDLabel:
            text: app.status
            theme_text_color: "ContrastParentBackground"
        MDLabel:
            size_hint_x: None
            text: "{}".format(datetime.utcfromtimestamp(app.timer).strftime('%H:%M:%S'))
            theme_text_color: "Custom"
            text_color: (0,0,0,.8)
            width: '64dp'
        MDIconButton:
            icon: "play"
            theme_text_color: "Custom"
            text_color: (0,0,0,.5) if app.running else (0,0,0,1)
            on_release: root.first_run_animation_start() if not app.first_run_animation_completed else root.start_stop(True)
        MDIconButton:
            icon: "coffee"
            theme_text_color: "Custom"
            text_color: (0,0,0,1) if app.running else (0,0,0,.5)
            on_release: root.start_stop(False)

    MDTabs:
        id: tabs
        tab_indicator_anim: True
        lock_swiping: True
        on_tab_switch: root.on_tab_switch(*args)

        Tab:
            padding: [0, 0]
            title: "Действия"
            ActionTab:
                id: action_tab
#        Tab:
#            title: "Предметы"
#            orientation: 'vertical'
#            spacing: '5dp'
#            MDBoxLayout:
#                size_hint_y: None
#                height: "50dp"
#                MDCheckbox:
#                    size_hint_x: .05
#                    on_active: root.set_use_all_items(self.active)
#                MDLabel:
#                    size_hint_x: .5
#                    text: "Предмет"
#                MDLabel:
#                    size_hint_x: .2
#                    text: "Макс цена"
#                MDLabel:
#                    size_hint_x: .2
#                    text: "Балк цена"
#                MDLabel:
#                    size_hint_x: .15
#                    text: "Количество"
#            RecycleView:
#                id: items_box
#                scroll_type: ['bars', 'content']
#                viewclass: 'ItemBox'
#                RecycleBoxLayout:
#                    default_size: None, dp(48)
#                    default_size_hint: 1, None
#                    size_hint_y: None
#                    height: self.minimum_height
#                    orientation: 'vertical'
#            MDBoxLayout:
#                adaptive_height: True
#                size_hint_y: None
#                spacing: "5dp"
#                Widget:
#                MDRectangleFlatIconButton:
#                    text: "Обновить из БД"
#                    icon: "refresh"
#                    on_release: root.refresh_items()
#
#                MDRectangleFlatIconButton:
#                    text: "Сохранить"
#                    icon: "content-save"

        Tab:
            title: "Логи"
            orientation: "vertical"
            spacing: "5dp"

#            MDBoxLayout:
#                size_hint_y: None
#                height: "50dp"
#                MDBoxLayout:
#                    orientation: "vertical"
#                    size_hint_x: None
#                    width: "32dp"
#                    Widget:
#                        size_hint_y: None
#                        height: "9dp"
#                    MDGridLayout:
#                        cols: 2
##                        spacing: [0, dp(5)]
#                        MiniCheckBox:
#                            font_size: "16sp"
#                            user_font_size: "16sp"
#                            pos_hint: {'center_x': .5}
#                            size_hint_x: .5
#                            selected_color: [.28, .60, .92, 1]
#                            checkbox_icon_normal: "numeric-1-circle-outline"
#                            checkbox_icon_down: "numeric-1-circle-outline"
#                        MiniCheckBox:
#                            font_size: "16sp"
#                            user_font_size: "16sp"
#                            pos_hint: {'center_x': .5}
#                            size_hint_x: .5
#                            selected_color: [.94, .45, .15, 1]
#                            checkbox_icon_normal: "numeric-2-circle-outline"
#                            checkbox_icon_down: "numeric-2-circle-outline"
#                        MiniCheckBox:
#                            font_size: "16sp"
#                            user_font_size: "16sp"
#                            pos_hint: {'center_x': .5}
#                            size_hint_x: .5
#                            selected_color: [1, 0, 0, 1]
#                            checkbox_icon_normal: "numeric-3-circle-outline"
#                            checkbox_icon_down: "numeric-3-circle-outline"
#                        MiniCheckBox:
#                            font_size: "16sp"
#                            user_font_size: "16sp"
#                            pos_hint: {'center_x': .5}
#                            size_hint_x: .5
#                            selected_color: [.31, .78, .47, 1]
#                            checkbox_icon_normal: "numeric-4-circle-outline"
#                            checkbox_icon_down: "numeric-4-circle-outline"
#                    Widget:
#                        size_hint_y: None
#                        height: "10dp"
#                MDLabel:
#                    halign: "center"
#                    size_hint_x: .13
#                    text: "Дата/время"
#                MDLabel:
#                    halign: "center"
#                    size_hint_x: .16
#                    text: "Ник"
#                MDLabel:
#                    halign: "center"
#                    size_hint_x: .13
#                    text: "Айди сделки"
#                MDLabel:
#                    halign: "center"
#                    size_hint_x: None
#                    width: "32dp"
#                    text: ""
#                MDLabel:
#                    halign: "center"
#                    size_hint_x: .5
#                    text: "Текст"
#
#            RecycleView:
#                id: logs_box
#                scroll_type: ['bars', 'content']
#                viewclass: 'LogBox'
#                RecycleBoxLayout:
#                    default_size: None, dp(32)
#                    default_size_hint: 1, None
#                    size_hint_y: None
#                    height: self.minimum_height
#                    orientation: 'vertical'
#
#            MDBoxLayout:
#                adaptive_height: True
#                size_hint_y: None
#                spacing: "5dp"
#                Widget:
#                    size_hint_x: .5
#                DatetimeTextInput:
#                    id: log_start
#                    size_hint_x: .25
#                    text: str(root.log_start)
#                    foreground_color: (1,1,1,1)
#                DatetimeTextInput:
#                    id: log_finish
#                    size_hint_x: .25
#                    text: str(root.log_finish)
#                    foreground_color: (1,1,1,1)
#                MDRectangleFlatIconButton:
#                    text: "Обновить логи"
#                    icon: "refresh"
#                    on_release: root.update_logs()

        Tab:
            title: "Настройки"
            SettingTab:

<Tab@MDBoxLayout+MDTabsBase>
    padding: "5dp"


<ItemBox>
    size_hint_y: None
    height: "50dp"
    MDCheckbox:
        size_hint_x: .05
        id: use
        active: root.use
    MDTextField:
        size_hint_x: .5
        id: name
        text: root.name
        text_color: app.theme_cls.text_color
    MDTextField:
        size_hint_x: .2
        id: max_price
        text: str(root.max_price)
        text_color: app.theme_cls.text_color
    MDTextField:
        size_hint_x: .2
        id: bulk_price
        text: str(root.bulk_price)
        text_color: app.theme_cls.text_color
    MDTextField:
        size_hint_x: .15
        id: qty
        text: str(root.qty)
        text_color: app.theme_cls.text_color


<LogBox>
    MDIcon:
        size_hint_x: None
        width: "32dp"
        halign: "center"
        icon: root.icons[root.level-1][0]
        theme_text_color: 'Custom'
        text_color: root.icons[root.level-1][1]
    MDLabel:
        size_hint_x: .13
        text: root.datetime
        text_size: self.size
        valign: 'middle'
        halign: 'center'
    Button:
        background_color: (1,1,1,0)
        background_normal: ""
        size_hint_x: .15
        text: root.character
        text_size: self.width, None
        valign: 'center'
        halign: 'left'
    Widget:
        size_hint_x: .01
    Button:
        background_color: (1,1,1,0)
        background_normal: ""
        size_hint_x: .12
        text: root.trade_id
        text_size: self.width, None
        valign: 'middle'
        halign: 'center'
    Button:
        size_hint_x: None
        background_normal: "images/test/1.png"
        background_down: "images/test/1.png"
        border: [0,0,0,0]
        width: self.height
    Widget:
        size_hint_x: .01
    MDLabel:
        size_hint_x: .50
        text: root.text
        valign: 'center'
        halign: 'left'


<MiniCheckBox>
    state: "down"

<DatetimeTextInput>
    background_color: (1,1,1,.1)
    multiline: False
    valign: 'middle'
    halign: 'center'
